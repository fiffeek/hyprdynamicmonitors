"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[1753],{28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var r=s(96540);const o={},i=r.createContext(o);function t(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),r.createElement(i.Provider,{value:n},e.children)}},44137:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/power_events-7260e7eb4d752483e9db51bfd53a5eb7.gif"},52231:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>t,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"configuration/power-events","title":"Power Events","description":"Power state monitoring uses D-Bus to listen for UPower events. This allows profiles and templates to react to AC/battery power changes.","source":"@site/versioned_docs/version-v1.3.10/configuration/power-events.md","sourceDirName":"configuration","slug":"/configuration/power-events","permalink":"/docs/v1.3.10/configuration/power-events","draft":false,"unlisted":false,"editUrl":"https://github.com/fiffeek/hyprdynamicmonitors/tree/main/docs/versioned_docs/version-v1.3.10/configuration/power-events.md","tags":[],"version":"v1.3.10","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Profiles","permalink":"/docs/v1.3.10/configuration/profiles"},"next":{"title":"Notifications","permalink":"/docs/v1.3.10/configuration/notifications"}}');var o=s(74848),i=s(28453);const t={sidebar_position:4},l="Power Events",a={},d=[{value:"Disabling Power Events",id:"disabling-power-events",level:2},{value:"Enabling Power Events",id:"enabling-power-events",level:2},{value:"Default Configuration",id:"default-configuration",level:2},{value:"Monitoring Power Events",id:"monitoring-power-events",level:3},{value:"Querying Power Status",id:"querying-power-status",level:2},{value:"Custom D-Bus Configuration",id:"custom-d-bus-configuration",level:2},{value:"Custom Signal Match Rules",id:"custom-signal-match-rules",level:3},{value:"Custom Signal Filters",id:"custom-signal-filters",level:3},{value:"Custom UPower Query",id:"custom-upower-query",level:3},{value:"Leave Empty Token",id:"leave-empty-token",level:2},{value:"Session Bus vs System Bus",id:"session-bus-vs-system-bus",level:2},{value:"Using Power State",id:"using-power-state",level:2},{value:"Behavior",id:"behavior",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"power-events",children:"Power Events"})}),"\n",(0,o.jsx)(n.p,{children:"Power state monitoring uses D-Bus to listen for UPower events. This allows profiles and templates to react to AC/battery power changes."}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"Power events",src:s(44137).A+"",width:"1400",height:"1000"})}),"\n",(0,o.jsx)(n.h2,{id:"disabling-power-events",children:"Disabling Power Events"}),"\n",(0,o.jsx)(n.p,{children:"To disable power state monitoring entirely:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"hyprdynamicmonitors run --disable-power-events\n"})}),"\n",(0,o.jsx)(n.p,{children:"When disabled:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["The system defaults to ",(0,o.jsx)(n.code,{children:"AC"})," power state"]}),"\n",(0,o.jsx)(n.li,{children:"No power events will be delivered"}),"\n",(0,o.jsx)(n.li,{children:"No D-Bus connection will be made"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"enabling-power-events",children:"Enabling Power Events"}),"\n",(0,o.jsxs)(n.p,{children:["Power events are enabled by default on laptops. They are disabled on desktops (the current chassis type is pulled from ",(0,o.jsx)(n.code,{children:"/sys/class/dmi/id/chassis_type"}),").\nIf you want to enable them anyway, run, e.g.:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"hyprdynamicmonitors run --disable-power-events=false\n"})}),"\n",(0,o.jsx)(n.h2,{id:"default-configuration",children:"Default Configuration"}),"\n",(0,o.jsx)(n.p,{children:"By default, the service listens for D-Bus signals:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Signal"}),": ",(0,o.jsx)(n.code,{children:"org.freedesktop.DBus.Properties.PropertiesChanged"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Interface"}),": ",(0,o.jsx)(n.code,{children:"org.freedesktop.DBus.Properties"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Member"}),": ",(0,o.jsx)(n.code,{children:"PropertiesChanged"})]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Path"}),": ",(0,o.jsx)(n.code,{children:"/org/freedesktop/UPower/devices/line_power_ACAD"})]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"monitoring-power-events",children:"Monitoring Power Events"}),"\n",(0,o.jsx)(n.p,{children:"You can monitor power events with:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'gdbus monitor -y -d org.freedesktop.UPower | grep -E "PropertiesChanged|Device(Added|Removed)"\n'})}),"\n",(0,o.jsx)(n.p,{children:"Example output:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"/org/freedesktop/UPower/devices/line_power_ACAD: org.freedesktop.DBus.Properties.PropertiesChanged ('org.freedesktop.UPower.Device', {'UpdateTime': <uint64 1756242314>, 'Online': <true>}, @as [])\n"})}),"\n",(0,o.jsx)(n.h2,{id:"querying-power-status",children:"Querying Power Status"}),"\n",(0,o.jsx)(n.p,{children:"On each event, the current power status is queried. Equivalent command:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"dbus-send --system --print-reply --dest=org.freedesktop.UPower \\\n  /org/freedesktop/UPower/devices/line_power_ACAD \\\n  org.freedesktop.DBus.Properties.Get \\\n  string:org.freedesktop.UPower.Device string:Online\n"})}),"\n",(0,o.jsx)(n.h2,{id:"custom-d-bus-configuration",children:"Custom D-Bus Configuration"}),"\n",(0,o.jsx)(n.p,{children:"You can customize which D-Bus signals to monitor and how to query power status."}),"\n",(0,o.jsx)(n.h3,{id:"custom-signal-match-rules",children:"Custom Signal Match Rules"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-toml",children:'[power_events]\n[[power_events.dbus_signal_match_rules]]\ninterface = "org.freedesktop.DBus.Properties"\nmember = "PropertiesChanged"\nobject_path = "/org/freedesktop/UPower/devices/line_power_ACAD"\n# sender = "org.freedesktop.UPower"  # Optional: specific sender\n'})}),"\n",(0,o.jsxs)(n.p,{children:["You can add multiple match rules to listen for different events like ",(0,o.jsx)(n.code,{children:"DeviceAdded"})," and ",(0,o.jsx)(n.code,{children:"DeviceRemoved"}),"."]}),"\n",(0,o.jsx)(n.h3,{id:"custom-signal-filters",children:"Custom Signal Filters"}),"\n",(0,o.jsx)(n.p,{children:"Filter received events by name to avoid noisy signals:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-toml",children:'[[power_events.dbus_signal_receive_filters]]\nname = "org.freedesktop.DBus.Properties.PropertiesChanged"\n'})}),"\n",(0,o.jsx)(n.h3,{id:"custom-upower-query",children:"Custom UPower Query"}),"\n",(0,o.jsx)(n.p,{children:"For non-standard power managers:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-toml",children:'[power_events.dbus_query_object]\ndestination = "org.freedesktop.UPower"\npath = "/org/freedesktop/UPower"\nmethod = "org.freedesktop.DBus.Properties.Get"\nexpected_discharging_value = "true"\n\n[[power_events.dbus_query_object.args]]\narg = "org.freedesktop.UPower"\n\n[[power_events.dbus_query_object.args]]\narg = "OnBattery"\n'})}),"\n",(0,o.jsx)(n.p,{children:"This is equivalent to:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"dbus-send --system --print-reply --dest=org.freedesktop.UPower \\\n  /org/freedesktop/UPower \\\n  org.freedesktop.DBus.Properties.Get \\\n  string:org.freedesktop.UPower string:OnBattery\n"})}),"\n",(0,o.jsx)(n.admonition,{type:"warning",children:(0,o.jsx)(n.p,{children:"The above query configuration is shown for reference only and is not recommended for production use. Stick with the default configuration unless you have a custom power management setup."})}),"\n",(0,o.jsx)(n.h2,{id:"leave-empty-token",children:"Leave Empty Token"}),"\n",(0,o.jsx)(n.p,{children:"To explicitly remove default values from D-Bus match rules:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-toml",children:'[[power_events.dbus_signal_match_rules]]\ninterface = "leaveEmptyToken"  # Removes interface match\nmember = "PropertiesChanged"\nobject_path = "/custom/path"\n'})}),"\n",(0,o.jsx)(n.h2,{id:"session-bus-vs-system-bus",children:"Session Bus vs System Bus"}),"\n",(0,o.jsx)(n.p,{children:"By default, the service connects to the system bus. To use the session bus:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"hyprdynamicmonitors run --connect-to-session-bus\n"})}),"\n",(0,o.jsx)(n.p,{children:"This is useful if your power line events are exposed in your user session bus instead of the system bus."}),"\n",(0,o.jsx)(n.h2,{id:"using-power-state",children:"Using Power State"}),"\n",(0,o.jsx)(n.p,{children:"Power state is available in templates via functions:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:"{{if isOnAC}}\nmonitor=eDP-1,2880x1920@120,0x0,2.0\n{{else}}\nmonitor=eDP-1,1920x1080@60,0x0,2.0\n{{end}}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["See ",(0,o.jsx)(n.a,{href:"../advanced/templates",children:"Templates"})," for more details."]}),"\n",(0,o.jsx)(n.h2,{id:"behavior",children:"Behavior"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Power status changes are only propagated when the state actually changes"}),"\n",(0,o.jsx)(n.li,{children:"Template/link replacement only occurs when file contents differ"}),"\n",(0,o.jsx)(n.li,{children:"This prevents unnecessary Hyprland reloads when nothing has changed"}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}}}]);