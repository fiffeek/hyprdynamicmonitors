"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[2072],{501:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"guides/power-events","title":"Running with Power Events","description":"What are power events?","source":"@site/versioned_docs/version-v1.3.8/guides/power-events.md","sourceDirName":"guides","slug":"/guides/power-events","permalink":"/docs/v1.3.8/guides/power-events","draft":false,"unlisted":false,"editUrl":"https://github.com/fiffeek/hyprdynamicmonitors/tree/main/docs/versioned_docs/version-v1.3.8/guides/power-events.md","tags":[],"version":"v1.3.8","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Guides","permalink":"/docs/v1.3.8/category/guides"},"next":{"title":"Adjusting Monitor Scale in the TUI","permalink":"/docs/v1.3.8/guides/scale"}}');var r=i(4848),o=i(8453);const t={sidebar_position:2},l="Running with Power Events",d={},c=[{value:"What are power events?",id:"what-are-power-events",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Do I need power events?",id:"do-i-need-power-events",level:2},{value:"Automatic detection",id:"automatic-detection",level:2},{value:"Verifying automatic detection",id:"verifying-automatic-detection",level:2},{value:"Advanced configuration",id:"advanced-configuration",level:2},{value:"Custom UPower device",id:"custom-upower-device",level:3},{value:"Enabling power events on desktops",id:"enabling-power-events-on-desktops",level:3},{value:"Disabling power events",id:"disabling-power-events",level:3},{value:"Using power events",id:"using-power-events",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Error: &quot;Object does not exist at path /org/freedesktop/UPower/devices/line_power_ACAD&quot;",id:"error-object-does-not-exist-at-path-orgfreedesktopupowerdevicesline_power_acad",level:3},{value:"Power events aren&#39;t switching profiles",id:"power-events-arent-switching-profiles",level:3},{value:"UPower is not installed",id:"upower-is-not-installed",level:3}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"running-with-power-events",children:"Running with Power Events"})}),"\n",(0,r.jsx)(n.h2,{id:"what-are-power-events",children:"What are power events?"}),"\n",(0,r.jsxs)(n.p,{children:["Power events allow ",(0,r.jsx)(n.code,{children:"hyprdynamicmonitors"})," to automatically switch monitor profiles based on your device's power state (AC power vs. battery). This is useful for scenarios like:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Switching to a power-saving profile when on battery"}),"\n",(0,r.jsx)(n.li,{children:"Enabling high refresh rates only when plugged in"}),"\n",(0,r.jsx)(n.li,{children:"Adjusting monitor scaling based on power state"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.p,{children:["To use power events, you need ",(0,r.jsx)(n.strong,{children:"UPower"})," installed and running on your system."]}),"\n",(0,r.jsx)(n.p,{children:"Check if UPower is running:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"systemctl status upower\n"})}),"\n",(0,r.jsx)(n.p,{children:"If it's not installed, install it using your package manager:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Arch Linux\nsudo pacman -S upower\n\n# Debian/Ubuntu\nsudo apt install upower\n\n# Fedora\nsudo dnf install upower\n"})}),"\n",(0,r.jsx)(n.p,{children:"After installation, enable and start the service:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"sudo systemctl enable --now upower\n"})}),"\n",(0,r.jsx)(n.h2,{id:"do-i-need-power-events",children:"Do I need power events?"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Laptop users:"})," Yes, if you want to:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Save battery by reducing refresh rates or resolution when unplugged"}),"\n",(0,r.jsx)(n.li,{children:"Use high-performance settings (e.g., 144Hz) only when on AC power"}),"\n",(0,r.jsx)(n.li,{children:"Automatically switch to a minimal monitor setup on battery"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Desktop users:"})," Usually no, since desktops are always plugged in. Power events are disabled by default on desktops. However, if you have a UPS (battery backup), you might want power events enabled to switch to a power-efficient configuration during power outages."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Only care about connected displays?"})," If you only want profiles to switch based on which monitors are physically connected (not power state), you can ",(0,r.jsx)(n.a,{href:"#disabling-power-events",children:"disable power events entirely"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"automatic-detection",children:"Automatic detection"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"hyprdynamicmonitors"})," automatically detects your device type and configures power events accordingly:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"On laptops:"})," Power events are enabled by default"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"On desktops:"})," Power events are disabled by default"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["For laptop users (or desktop users who explicitly enable power events), the tool will automatically detect your UPower device by matching against ",(0,r.jsx)(n.a,{href:"https://github.com/fiffeek/hyprdynamicmonitors/blob/main/internal/utils/power.go#L14",children:"a well-known list of devices"}),". This means ",(0,r.jsx)(n.strong,{children:"most laptop users don't need any configuration"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"verifying-automatic-detection",children:"Verifying automatic detection"}),"\n",(0,r.jsx)(n.p,{children:"To check that automatic detection is working correctly, run:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"hyprdynamicmonitors run --run-once --dry-run\n"})}),"\n",(0,r.jsx)(n.p,{children:"Look for a line like this in the output:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'INFO[...] Inferred power line    power_line="/org/freedesktop/UPower/devices/line_power_ACAD"\n'})}),"\n",(0,r.jsxs)(n.p,{children:["(The exact device name may vary, e.g., ",(0,r.jsx)(n.code,{children:"line_power_AC"}),", ",(0,r.jsx)(n.code,{children:"line_power_ADP1"}),", etc.)"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"If you see this message:"})," Everything is working correctly and you don't need to configure anything."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"If you don't see this message:"})," Automatic detection failed. This could mean:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Power events are disabled (check if you're on desktop or using ",(0,r.jsx)(n.code,{children:"--disable-power-events"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["Your power device isn't in the recognized list (see ",(0,r.jsx)(n.a,{href:"#custom-upower-device",children:"Custom UPower device"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:["UPower isn't running or isn't installed (see ",(0,r.jsx)(n.a,{href:"#prerequisites",children:"Prerequisites"}),")"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"advanced-configuration",children:"Advanced configuration"}),"\n",(0,r.jsx)(n.admonition,{title:"Important",type:"tip",children:(0,r.jsxs)(n.p,{children:["When using ",(0,r.jsx)(n.code,{children:"--disable-power-events"}),", ensure both ",(0,r.jsx)(n.code,{children:"run"})," and ",(0,r.jsx)(n.code,{children:"tui"})," commands use the same flag. Since profiles may have power state conditions (e.g., require AC power), the TUI needs to know the current power state to correctly display which profile would be active."]})}),"\n",(0,r.jsx)(n.h3,{id:"custom-upower-device",children:"Custom UPower device"}),"\n",(0,r.jsx)(n.p,{children:"If automatic detection fails or detects the wrong device, you can manually specify which UPower device to use. First, list your available power devices:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"upower -e\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Then override the power device in your configuration file at ",(0,r.jsx)(n.code,{children:"~/.config/hyprdynamicmonitors/config.toml"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'[power_events]\n\n[power_events.dbus_query_object]\npath = "/org/freedesktop/UPower/devices/line_power_XYZ"\n\n[[power_events.dbus_signal_match_rules]]\nobject_path = "/org/freedesktop/UPower/devices/line_power_XYZ"\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Replace ",(0,r.jsx)(n.code,{children:"/org/freedesktop/UPower/devices/line_power_XYZ"})," with your actual power device path from ",(0,r.jsx)(n.code,{children:"upower -e"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["For more configuration options, see the ",(0,r.jsx)(n.a,{href:"/docs/v1.3.8/configuration/power-events",children:"Power Events configuration section"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"enabling-power-events-on-desktops",children:"Enabling power events on desktops"}),"\n",(0,r.jsx)(n.p,{children:"Power events are disabled by default on desktops, but you can explicitly enable them. Common reasons to enable:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Your desktop has a UPS (battery backup) and you want power-saving profiles during outages"}),"\n",(0,r.jsx)(n.li,{children:"You're testing power-related profile configurations"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"hyprdynamicmonitors run --disable-power-events=false\n"})}),"\n",(0,r.jsx)(n.h3,{id:"disabling-power-events",children:"Disabling power events"}),"\n",(0,r.jsx)(n.p,{children:"If you only want to switch profiles based on connected monitors (not power state), you can disable power events:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"hyprdynamicmonitors run --disable-power-events\n"})}),"\n",(0,r.jsx)(n.h2,{id:"using-power-events",children:"Using power events"}),"\n",(0,r.jsxs)(n.p,{children:["You can use them in ",(0,r.jsx)(n.a,{href:"/docs/v1.3.8/configuration/profiles#profile-structure",children:"profile matching criteria"})," and in ",(0,r.jsx)(n.a,{href:"/docs/v1.3.8/advanced/templates#template-functions",children:"your templates"}),"."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"error-object-does-not-exist-at-path-orgfreedesktopupowerdevicesline_power_acad",children:'Error: "Object does not exist at path /org/freedesktop/UPower/devices/line_power_ACAD"'}),"\n",(0,r.jsxs)(n.p,{children:["This error means ",(0,r.jsx)(n.code,{children:"hyprdynamicmonitors"})," couldn't find the expected power device."]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Quick fix - Disable power events"})," (if you don't need them):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"hyprdynamicmonitors run --disable-power-events\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Full fix - Configure a custom power device"})," (if you need power events):"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Check if UPower is running:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"systemctl status upower\n"})}),"\n",(0,r.jsxs)(n.p,{children:["If not running, start it: ",(0,r.jsx)(n.code,{children:"sudo systemctl start upower"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"List your available power devices:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"upower -e\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Look for a line containing ",(0,r.jsx)(n.code,{children:"line_power"})," (ignore battery/display devices). Example: ",(0,r.jsx)(n.code,{children:"/org/freedesktop/UPower/devices/line_power_AC"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Configure the correct device following the ",(0,r.jsx)(n.a,{href:"#custom-upower-device",children:"Custom UPower device section"})," above."]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Help improve automatic detection:"})," If you have a power device that should be recognized automatically, please contribute by:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Submitting a PR to add your device to ",(0,r.jsx)(n.a,{href:"https://github.com/fiffeek/hyprdynamicmonitors/blob/main/internal/utils/power.go#L14",children:"the recognized device list"})]}),"\n",(0,r.jsxs)(n.li,{children:["Opening a ",(0,r.jsx)(n.a,{href:"https://github.com/fiffeek/hyprdynamicmonitors/issues",children:"GitHub issue"})," with your device information"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"power-events-arent-switching-profiles",children:"Power events aren't switching profiles"}),"\n",(0,r.jsx)(n.p,{children:"If automatic detection succeeded but profiles aren't switching when you plug/unplug:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Verify your profile has power state conditions:"}),"\nCheck your ",(0,r.jsx)(n.code,{children:"config.toml"})," to ensure profiles specify power requirements:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-toml",children:'[profiles.high_performance]\n# ... monitor conditions ...\n\n[[profiles.high_performance.conditions.required_power_states]]\nstate = "AC"  # Only active when on AC power\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Check current power state:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"upower -i /org/freedesktop/UPower/devices/line_power_ACAD\n"})}),"\n",(0,r.jsxs)(n.p,{children:["(Replace ",(0,r.jsx)(n.code,{children:"line_power_ACAD"}),' with your actual device from the "Inferred power line" message)']}),"\n",(0,r.jsxs)(n.p,{children:["Look for the ",(0,r.jsx)(n.code,{children:"online"})," property (yes = AC power, no = battery)"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Test with dry-run:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Unplug your laptop, then run:\nhyprdynamicmonitors run --run-once --dry-run\n\n# Plug it back in, then run:\nhyprdynamicmonitors run --run-once --dry-run\n"})}),"\n",(0,r.jsx)(n.p,{children:"The output should show different profiles being selected based on power state."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Verify daemon is using the same configuration:"}),"\nIf you're running the daemon with ",(0,r.jsx)(n.code,{children:"exec-once"}),", make sure you're not passing conflicting flags like ",(0,r.jsx)(n.code,{children:"--disable-power-events"}),"."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"upower-is-not-installed",children:"UPower is not installed"}),"\n",(0,r.jsxs)(n.p,{children:["If you get errors about UPower not being available, see the ",(0,r.jsx)(n.a,{href:"#prerequisites",children:"Prerequisites"})," section for installation instructions."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>l});var s=i(6540);const r={},o=s.createContext(r);function t(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);